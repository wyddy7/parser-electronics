# –ü–æ–ª–Ω–æ–µ –¥–µ–¥—É–∫—Ç–∏–≤–Ω–æ–µ —Ä–∞—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ: –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤

## –î–∞—Ç–∞: 2025-01-XX
## –¶–µ–ª—å: –†–µ–∞–ª–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ –¥–ª—è —É—Å–∫–æ—Ä–µ–Ω–∏—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ 8000+ —Ç–æ–≤–∞—Ä–æ–≤

---

## 1. –¢–ï–ö–£–©–ï–ï –°–û–°–¢–û–Ø–ù–ò–ï –°–ò–°–¢–ï–ú–´

### 1.1. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø–∞—Ä—Å–µ—Ä–æ–≤

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

1. **Factory Pattern** (`src/parsers/factory.py`):
   - –î–≤–∞ —Ä–µ–µ—Å—Ç—Ä–∞: `PARSER_REGISTRY` (sync) –∏ `ASYNC_PARSER_REGISTRY` (async)
   - –§—É–Ω–∫—Ü–∏–∏ —Å–æ–∑–¥–∞–Ω–∏—è: `create_parser()` –∏ `create_async_parser()`
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ `_auto_register()`
   - –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–≥–æ –∏–º–ø–æ—Ä—Ç–∞

2. **–ë–∞–∑–æ–≤—ã–µ –∫–ª–∞—Å—Å—ã**:
   - `BaseParser` (sync) - –±–∞–∑–æ–≤—ã–π —Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä
   - `AsyncBaseParser` (async) - –±–∞–∑–æ–≤—ã–π –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω—ã–π –ø–∞—Ä—Å–µ—Ä —Å:
     - `httpx.AsyncClient` —Å connection pooling
     - `asyncio.Semaphore` –¥–ª—è rate limiting
     - Retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff
     - Context manager (`__aenter__`, `__aexit__`)

3. **–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã**:
   - `ElectronpriborAsyncParser` - async –ø–∞—Ä—Å–µ—Ä –¥–ª—è electronpribor.ru
   - `PristAsyncParser` - async –ø–∞—Ä—Å–µ—Ä –¥–ª—è prist.ru (2 –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Ç–æ–≤–∞—Ä: –ø–æ–∏—Å–∫ + —Å—Ç—Ä–∞–Ω–∏—Ü–∞)

### 1.2. –¢–µ–∫—É—â–∏–π –ø—Ä–æ—Ü–µ—Å—Å –æ–±—Ä–∞–±–æ—Ç–∫–∏ (`src/main.py`)

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ:**

```python
# –¢–µ–∫—É—â–∏–π CLI
@click.option('--parser', type=str, default=None, help='–ò–º—è –ø–∞—Ä—Å–µ—Ä–∞')

# –û–±—Ä–∞–±–æ—Ç–∫–∞
if use_async:
    results = asyncio.run(_process_products_async(
        parser_instance, df, total_products, log,
        excel_config, writer, checkpoint_writer, output, parser_name,
        batch_size, checkpoint_interval, batch_delay
    ))
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ùå –¢–æ–ª—å–∫–æ **–æ–¥–∏–Ω –ø–∞—Ä—Å–µ—Ä** –∑–∞ –∑–∞–ø—É—Å–∫
- ‚ùå –ù–µ—Ç –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Å–µ—Ä–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- ‚ùå –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ **–æ—Ç–¥–µ–ª—å–Ω—ã–µ —Ñ–∞–π–ª—ã** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞

### 1.3. ExcelWriter (`src/excel/writer.py`)

**–§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ:**

```python
def write_results(
    self,
    original_df: pd.DataFrame,
    results: Dict[str, Optional[Dict]],
    output_filename: Optional[str] = None,
    parser_name: Optional[str] = None
) -> str:
    # –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –Ω–∞–∑–≤–∞–Ω–∏—è –∫–æ–ª–æ–Ω–æ–∫
    parser_display_name = parser_name.replace('_', ' ').title() if parser_name else "Parser"
    price_column = f'–¶–µ–Ω–∞ {parser_display_name}'
    
    # –î–æ–±–∞–≤–ª—è–µ–º –Ω–æ–≤—ã–µ –∫–æ–ª–æ–Ω–∫–∏
    result_df[price_column] = None
    result_df['–ù–∞–∑–≤–∞–Ω–∏–µ –Ω–∞ —Å–∞–π—Ç–µ'] = None
    result_df['–°—Å—ã–ª–∫–∞ –Ω–∞ —Ç–æ–≤–∞—Ä'] = None
    result_df['–°—Ç–∞—Ç—É—Å'] = '–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω'
```

**–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:**
- ‚ùå –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ **–æ–¥–∏–Ω –ø–∞—Ä—Å–µ—Ä** –∑–∞ —Ä–∞–∑
- ‚ùå –ö–æ–ª–æ–Ω–∫–∏ –∂–µ—Å—Ç–∫–æ –ø—Ä–∏–≤—è–∑–∞–Ω—ã –∫ –æ–¥–Ω–æ–º—É –ø–∞—Ä—Å–µ—Ä—É
- ‚ùå –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–ª—è –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫ —Ü–µ–Ω

---

## 2. –¢–†–ï–ë–û–í–ê–ù–ò–Ø –ò –û–ñ–ò–î–ê–ï–ú–û–ï –ü–û–í–ï–î–ï–ù–ò–ï

### 2.1. –ë–∏–∑–Ω–µ—Å-—Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è

**–ü—Ä–æ–±–ª–µ–º–∞:**
- 8000 —Ç–æ–≤–∞—Ä–æ–≤ √ó 2 –ø–∞—Ä—Å–µ—Ä–∞ = **–æ—á–µ–Ω—å –¥–æ–ª–≥–æ** (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ ~2.3 —á–∞—Å–∞)
- –ù—É–∂–Ω–æ –∑–∞–ø—É—Å–∫–∞—Ç—å –æ–±–∞ –ø–∞—Ä—Å–µ—Ä–∞ **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** –¥–ª—è —ç–∫–æ–Ω–æ–º–∏–∏ –≤—Ä–µ–º–µ–Ω–∏

**–¶–µ–ª—å:**
- –ó–∞–ø—É—Å–∫ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ **–æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ** –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –≤ **–æ–¥–Ω–æ–º Excel —Ñ–∞–π–ª–µ** —Å –∫–æ–ª–æ–Ω–∫–∞–º–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å—Ä–∞–≤–Ω–µ–Ω–∏–µ —Ü–µ–Ω –º–µ–∂–¥—É –ø–∞—Ä—Å–µ—Ä–∞–º–∏

### 2.2. –û–∂–∏–¥–∞–µ–º–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ

**CLI –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å:**
```bash
# –í–∞—Ä–∏–∞–Ω—Ç 1: –°–ø–∏—Å–æ–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é
python src/main.py --parsers electronpribor,prist

# –í–∞—Ä–∏–∞–Ω—Ç 2: –ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —Ñ–ª–∞–≥–∏ (–º–µ–Ω–µ–µ —É–¥–æ–±–Ω–æ)
python src/main.py --parser electronpribor --parser prist
```

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –û–±–∞ –ø–∞—Ä—Å–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç **–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ** –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
- –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–±—ä–µ–¥–∏–Ω—è—é—Ç—Å—è –≤ **–æ–¥–∏–Ω DataFrame**
- Excel —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:
  - `–¶–µ–Ω–∞ Electronpribor` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–¶–µ–Ω–∞ Prist` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–ù–∞–∑–≤–∞–Ω–∏–µ Electronpribor` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–ù–∞–∑–≤–∞–Ω–∏–µ Prist` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–°—Å—ã–ª–∫–∞ Electronpribor` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–°—Å—ã–ª–∫–∞ Prist` (–∫–æ–ª–æ–Ω–∫–∞)
  - `–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω` (–∫–æ–ª–æ–Ω–∫–∞, –æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
  - `–°—Ç–∞—Ç—É—Å` (–æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å)

---

## 3. –ê–†–•–ò–¢–ï–ö–¢–£–†–ù–´–ô –ü–õ–ê–ù

### 3.1. Best Practices –∏–∑ Context7 (httpx)

**–ò–∑—É—á–µ–Ω–Ω—ã–µ –ø–∞—Ç—Ç–µ—Ä–Ω—ã:**

1. **–ú–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ AsyncClient:**
   ```python
   async with httpx.AsyncClient() as client1, httpx.AsyncClient() as client2:
       tasks = [
           client1.get(url1),
           client2.get(url2)
       ]
       responses = await asyncio.gather(*tasks)
   ```

2. **Connection Pooling:**
   ```python
   limits = httpx.Limits(max_connections=100, max_keepalive_connections=20)
   async with httpx.AsyncClient(limits=limits) as client:
       # –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –∏–º–µ–µ—Ç —Å–≤–æ–π –ø—É–ª —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
   ```

3. **–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã:**
   ```python
   tasks = [fetch_user(client, user_id) for user_id in range(1, 6)]
   users = await asyncio.gather(*tasks)
   ```

**–í—ã–≤–æ–¥—ã:**
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –¥–æ–ª–∂–µ–Ω –∏–º–µ—Ç—å **—Å–≤–æ–π AsyncClient** (—É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ)
- ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `asyncio.gather()` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ –ø–∞—Ä—Å–µ—Ä–æ–≤
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä —É–ø—Ä–∞–≤–ª—è–µ—Ç —Å–≤–æ–∏–º rate limiting —á–µ—Ä–µ–∑ Semaphore

### 3.2. –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ —Ä–µ—à–µ–Ω–∏–µ

**–ü–æ–¥—Ö–æ–¥: "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ç–æ–≤–∞—Ä–∞"**

```
–î–ª—è –∫–∞–∂–¥–æ–≥–æ —Ç–æ–≤–∞—Ä–∞:
  ‚îú‚îÄ –ü–∞—Ä—Å–µ—Ä 1 (electronpribor) ‚îÄ‚îÄ‚îê
  ‚îÇ                              ‚îú‚îÄ‚Üí asyncio.gather() ‚Üí –†–µ–∑—É–ª—å—Ç–∞—Ç—ã
  ‚îî‚îÄ –ü–∞—Ä—Å–µ—Ä 2 (prist) ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îÄ‚îò
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ –ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–º –∫–æ–¥–µ
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç —Å–≤–æ—é –ª–æ–≥–∏–∫—É (rate limiting, retry, etc.)
- ‚úÖ –õ–µ–≥–∫–æ –º–∞—Å—à—Ç–∞–±–∏—Ä—É–µ—Ç—Å—è –Ω–∞ N –ø–∞—Ä—Å–µ—Ä–æ–≤
- ‚úÖ –û—à–∏–±–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ

**–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –ø–æ–¥—Ö–æ–¥ (–æ—Ç–∫–ª–æ–Ω–µ–Ω):**
- "–ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –Ω–∞ —É—Ä–æ–≤–Ω–µ –±–∞—Ç—á–∞" - —Å–ª–æ–∂–Ω–µ–µ, –±–æ–ª—å—à–µ –∏–∑–º–µ–Ω–µ–Ω–∏–π

---

## 4. –î–ï–¢–ê–õ–¨–ù–´–ô –ü–õ–ê–ù –†–ï–ê–õ–ò–ó–ê–¶–ò–ò

### 4.1. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è CLI (`src/main.py`)

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–ù–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `--parsers`:**
   ```python
   @click.option(
       '--parsers',
       type=str,
       default=None,
       help='–°–ø–∏—Å–æ–∫ –ø–∞—Ä—Å–µ—Ä–æ–≤ —á–µ—Ä–µ–∑ –∑–∞–ø—è—Ç—É—é (–Ω–∞–ø—Ä–∏–º–µ—Ä: electronpribor,prist)'
   )
   ```

2. **–õ–æ–≥–∏–∫–∞ –≤—ã–±–æ—Ä–∞ –ø–∞—Ä—Å–µ—Ä–æ–≤:**
   ```python
   if parsers:
       parser_names = [p.strip() for p in parsers.split(',')]
       # –í–∞–ª–∏–¥–∞—Ü–∏—è: –≤—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å enabled –∏ async
   else:
       # Fallback –Ω–∞ —Å—Ç–∞—Ä—É—é –ª–æ–≥–∏–∫—É (--parser –∏–ª–∏ –ø–µ—Ä–≤—ã–π enabled)
   ```

3. **–°–æ–∑–¥–∞–Ω–∏–µ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤:**
   ```python
   parser_instances = []
   for parser_name in parser_names:
       parser_config = config_loader.get_parser_config(parser_name)
       async_config = parser_config.get('async', {})
       if not async_config.get('enabled', False):
           raise ValueError(f"–ü–∞—Ä—Å–µ—Ä {parser_name} –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å async")
       
       parser_instance = create_async_parser(parser_name, parser_config, log, search_config)
       parser_instances.append((parser_name, parser_instance))
   ```

### 4.2. –ù–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

**–°–æ–∑–¥–∞—Ç—å `_process_products_parallel_async()`:**

```python
async def _process_products_parallel_async(
    parser_instances: List[Tuple[str, AsyncBaseParser]],
    df: pd.DataFrame,
    total_products: int,
    log: structlog.BoundLogger,
    excel_config: Dict,
    writer: ExcelWriter,
    checkpoint_writer: ExcelWriter,
    output: Optional[str],
    batch_size: int,
    checkpoint_interval: int,
    batch_delay: float
) -> Dict[str, Dict[str, Optional[Dict]]]:
    """
    –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–∞—Ä—Å–µ—Ä–æ–≤.
    
    Returns:
        Dict[product_name, Dict[parser_name, result]]
        –ù–∞–ø—Ä–∏–º–µ—Ä: {
            "–ê–ö–ò–ü-3409": {
                "electronpribor": {"price": 1000, "name": "...", "url": "..."},
                "prist": {"price": 1200, "name": "...", "url": "..."}
            }
        }
    """
    results = {}  # product_name -> {parser_name -> result}
    
    async def process_single_product_parallel(idx, row):
        """–û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –æ–¥–∏–Ω —Ç–æ–≤–∞—Ä —á–µ—Ä–µ–∑ –≤—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ"""
        product_name = row.get('product_name', '')
        
        if not product_name or product_name == 'nan':
            return product_name, {}
        
        # –°–æ–∑–¥–∞–µ–º –∑–∞–¥–∞—á–∏ –¥–ª—è –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
        tasks = {}
        for parser_name, parser_instance in parser_instances:
            product_log = log.bind(product=product_name, parser=parser_name, index=idx)
            product_log.debug("processing_product")
            tasks[parser_name] = parser_instance.search_product(product_name)
        
        # –ó–∞–ø—É—Å–∫–∞–µ–º –≤—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
        parser_results = await asyncio.gather(*tasks.values(), return_exceptions=True)
        
        # –§–æ—Ä–º–∏—Ä—É–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç
        product_results = {}
        for (parser_name, _), result in zip(parser_instances, parser_results):
            if isinstance(result, Exception):
                log.error("parser_error",
                         product=product_name,
                         parser=parser_name,
                         error=str(result),
                         error_type=type(result).__name__)
                product_results[parser_name] = None
            else:
                product_results[parser_name] = result
        
        return product_name, product_results
    
    # –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø–æ –±–∞—Ç—á–∞–º (–∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ _process_products_async)
    # ...
    
    return results
```

**–ö–ª—é—á–µ–≤—ã–µ –º–æ–º–µ–Ω—Ç—ã:**
- ‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `asyncio.gather()` –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- ‚úÖ `return_exceptions=True` - –æ—à–∏–±–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ
- ‚úÖ –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —Å–≤–æ–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–µ (`async with parser_instance`)

### 4.3. –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏ –ø–∞—Ä—Å–µ—Ä–æ–≤

**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞–∂–¥—ã–π –ø–∞—Ä—Å–µ—Ä –∏–º–µ–µ—Ç —Å–≤–æ–π `async with` context manager.

**–†–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `asyncio.gather()` –¥–ª—è –≤—Ö–æ–¥–∞ –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã:

```python
async def _enter_parser_contexts(parser_instances):
    """–í—Ö–æ–¥–∏—Ç –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ"""
    await asyncio.gather(*[parser.__aenter__() for _, parser in parser_instances])

async def _exit_parser_contexts(parser_instances):
    """–í—ã—Ö–æ–¥–∏—Ç –∏–∑ –∫–æ–Ω—Ç–µ–∫—Å—Ç–æ–≤ –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ"""
    await asyncio.gather(*[parser.__aexit__(None, None, None) for _, parser in parser_instances])
```

**–ò–ª–∏ –ø—Ä–æ—â–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤–ª–æ–∂–µ–Ω–Ω—ã–µ `async with`:

```python
# –°–æ–∑–¥–∞–µ–º –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã
contexts = [parser.__aenter__() for _, parser in parser_instances]
try:
    parsers = await asyncio.gather(*contexts)
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º parsers
finally:
    await asyncio.gather(*[parser.__aexit__(None, None, None) for parser in parsers])
```

**–õ—É—á—à–µ–µ —Ä–µ—à–µ–Ω–∏–µ:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `contextlib.AsyncExitStack`:

```python
from contextlib import AsyncExitStack

async with AsyncExitStack() as stack:
    # –í—Ö–æ–¥–∏–º –≤ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –≤—Å–µ—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤
    active_parsers = []
    for parser_name, parser_instance in parser_instances:
        parser = await stack.enter_async_context(parser_instance)
        active_parsers.append((parser_name, parser))
    
    # –ò—Å–ø–æ–ª—å–∑—É–µ–º active_parsers –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
    # –ü—Ä–∏ –≤—ã—Ö–æ–¥–µ –≤—Å–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç—ã –∑–∞–∫—Ä–æ—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
```

### 4.4. –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è ExcelWriter

**–ù–æ–≤–∞—è —Å–∏–≥–Ω–∞—Ç—É—Ä–∞ `write_results()`:**

```python
def write_results(
    self,
    original_df: pd.DataFrame,
    results: Dict[str, Dict[str, Optional[Dict]]],  # –ò–∑–º–µ–Ω–µ–Ω–æ!
    output_filename: Optional[str] = None,
    parser_names: Optional[List[str]] = None  # –ò–∑–º–µ–Ω–µ–Ω–æ!
) -> str:
    """
    –ó–∞–ø–∏—Å—ã–≤–∞–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –ø–∞—Ä—Å–∏–Ω–≥–∞ –æ—Ç –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –ø–∞—Ä—Å–µ—Ä–æ–≤.
    
    Args:
        original_df: –û—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π DataFrame
        results: Dict[product_name, Dict[parser_name, result]]
        output_filename: –ò–º—è —Ñ–∞–π–ª–∞
        parser_names: –°–ø–∏—Å–æ–∫ –∏–º–µ–Ω –ø–∞—Ä—Å–µ—Ä–æ–≤
    """
    result_df = original_df.copy()
    
    # –°–æ–∑–¥–∞–µ–º –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞
    for parser_name in parser_names:
        parser_display = parser_name.replace('_', ' ').title()
        
        result_df[f'–¶–µ–Ω–∞ {parser_display}'] = None
        result_df[f'–ù–∞–∑–≤–∞–Ω–∏–µ {parser_display}'] = None
        result_df[f'–°—Å—ã–ª–∫–∞ {parser_display}'] = None
    
    # –û–±—â–∞—è –∫–æ–ª–æ–Ω–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
    result_df['–°—Ç–∞—Ç—É—Å'] = '–ù–µ –æ–±—Ä–∞–±–æ—Ç–∞–Ω'
    
    # –û–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ: –∫–æ–ª–æ–Ω–∫–∞ —Ä–∞–∑–Ω–∏—Ü—ã —Ü–µ–Ω (–µ—Å–ª–∏ 2 –ø–∞—Ä—Å–µ—Ä–∞)
    if len(parser_names) == 2:
        result_df['–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω'] = None
    
    # –ó–∞–ø–æ–ª–Ω—è–µ–º –¥–∞–Ω–Ω—ã–º–∏
    for idx, row in result_df.iterrows():
        product_name = row.get('product_name', '')
        
        if product_name in results:
            product_results = results[product_name]
            
            prices = []
            for parser_name in parser_names:
                parser_display = parser_name.replace('_', ' ').title()
                result = product_results.get(parser_name)
                
                if result:
                    price = result.get('price', 0)
                    result_df.at[idx, f'–¶–µ–Ω–∞ {parser_display}'] = price
                    result_df.at[idx, f'–ù–∞–∑–≤–∞–Ω–∏–µ {parser_display}'] = result.get('name')
                    result_df.at[idx, f'–°—Å—ã–ª–∫–∞ {parser_display}'] = result.get('url')
                    
                    if price and price > 0:
                        prices.append(price)
            
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –æ–±—â–∏–π —Å—Ç–∞—Ç—É—Å
            if len(prices) == len(parser_names):
                result_df.at[idx, '–°—Ç–∞—Ç—É—Å'] = '–ù–∞–π–¥–µ–Ω–æ –≤–æ –≤—Å–µ—Ö'
            elif len(prices) > 0:
                result_df.at[idx, '–°—Ç–∞—Ç—É—Å'] = '–ù–∞–π–¥–µ–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ'
            else:
                result_df.at[idx, '–°—Ç–∞—Ç—É—Å'] = '–ù–µ –Ω–∞–π–¥–µ–Ω–æ'
            
            # –†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω (–µ—Å–ª–∏ 2 –ø–∞—Ä—Å–µ—Ä–∞)
            if len(parser_names) == 2 and len(prices) == 2:
                result_df.at[idx, '–†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω'] = abs(prices[0] - prices[1])
    
    # –°–æ—Ö—Ä–∞–Ω—è–µ–º –∏ —Ñ–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º
    # ...
```

### 4.5. Checkpoint –º–µ—Ö–∞–Ω–∏–∑–º

**–ò–∑–º–µ–Ω–µ–Ω–∏—è:**

1. **–°—Ç—Ä—É–∫—Ç—É—Ä–∞ checkpoint:**
   ```python
   {
       "product_name": {
           "electronpribor": {"price": 1000, ...},
           "prist": {"price": 1200, ...}
       }
   }
   ```

2. **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ checkpoint:**
   - –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ —Ç–µ–∫—É—â–µ–º—É, –Ω–æ —Å –Ω–æ–≤–æ–π —Å—Ç—Ä—É–∫—Ç—É—Ä–æ–π –¥–∞–Ω–Ω—ã—Ö

3. **–í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ—Å–ª–µ –ø—Ä–µ—Ä—ã–≤–∞–Ω–∏—è:**
   - –ó–∞–≥—Ä—É–∂–∞—Ç—å checkpoint —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–∞—Ä—Å–µ—Ä–∞–º–∏
   - –ü—Ä–æ–¥–æ–ª–∂–∞—Ç—å –æ–±—Ä–∞–±–æ—Ç–∫—É —Ç–æ–ª—å–∫–æ –¥–ª—è —Ç–æ–≤–∞—Ä–æ–≤, –≥–¥–µ –Ω–µ –≤—Å–µ –ø–∞—Ä—Å–µ—Ä—ã –∑–∞–≤–µ—Ä—à–∏–ª–∏—Å—å

---

## 5. –û–ñ–ò–î–ê–ï–ú–´–ï –†–ï–ó–£–õ–¨–¢–ê–¢–´

### 5.1. –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å

**–¢–µ–∫—É—â–µ–µ –≤—Ä–µ–º—è (–ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ):**
- electronpribor: ~36 –º–∏–Ω—É—Ç (8000 —Ç–æ–≤–∞—Ä–æ–≤)
- prist: ~100 –º–∏–Ω—É—Ç (8000 —Ç–æ–≤–∞—Ä–æ–≤)
- **–ò—Ç–æ–≥–æ: ~136 –º–∏–Ω—É—Ç (~2.3 —á–∞—Å–∞)**

**–û–∂–∏–¥–∞–µ–º–æ–µ –≤—Ä–µ–º—è (–ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ):**
- –û–±–∞ –ø–∞—Ä—Å–µ—Ä–∞ —Ä–∞–±–æ—Ç–∞—é—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- **–ò—Ç–æ–≥–æ: ~100 –º–∏–Ω—É—Ç (~1.7 —á–∞—Å–∞)** (–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è —Å–∞–º—ã–º –º–µ–¥–ª–µ–Ω–Ω—ã–º –ø–∞—Ä—Å–µ—Ä–æ–º)
- **–≠–∫–æ–Ω–æ–º–∏—è: ~36 –º–∏–Ω—É—Ç (26%)**

### 5.2. –§–æ—Ä–º–∞—Ç –≤—ã—Ö–æ–¥–Ω–æ–≥–æ —Ñ–∞–π–ª–∞

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ Excel:**

| –ù–∞–∑–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ | –¶–µ–Ω–∞ Electronpribor | –ù–∞–∑–≤–∞–Ω–∏–µ Electronpribor | –°—Å—ã–ª–∫–∞ Electronpribor | –¶–µ–Ω–∞ Prist | –ù–∞–∑–≤–∞–Ω–∏–µ Prist | –°—Å—ã–ª–∫–∞ Prist | –†–∞–∑–Ω–∏—Ü–∞ —Ü–µ–Ω | –°—Ç–∞—Ç—É—Å |
|-----------------|---------------------|------------------------|----------------------|------------|---------------|-------------|-------------|--------|
| –ê–ö–ò–ü-3409 | 1000 | –ê–ö–ò–ü-3409/3–ê | https://... | 1200 | –ê–ö–ò–ü-3409/3–ê | https://... | 200 | –ù–∞–π–¥–µ–Ω–æ –≤–æ –≤—Å–µ—Ö |
| –ê–ö–ò–ü-4205 | 5000 | –ê–ö–ò–ü-4205/3 | https://... | None | None | None | None | –ù–∞–π–¥–µ–Ω–æ —á–∞—Å—Ç–∏—á–Ω–æ |

### 5.3. –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏:**

```json
{
  "event": "parallel_parsing_started",
  "parsers": ["electronpribor", "prist"],
  "total_products": 8000
}

{
  "event": "product_processing_parallel",
  "product": "–ê–ö–ò–ü-3409",
  "parsers": ["electronpribor", "prist"],
  "results": {
    "electronpribor": {"price": 1000},
    "prist": {"price": 1200}
  }
}
```

---

## 6. –í–´–í–û–î–´ –ò –†–ï–ö–û–ú–ï–ù–î–ê–¶–ò–ò

### 6.1. –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –≤—ã–≤–æ–¥—ã

1. ‚úÖ **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –≥–æ—Ç–æ–≤–∞:** Factory pattern –∏ async –ø–∞—Ä—Å–µ—Ä—ã —É–∂–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ —ç–∫–∑–µ–º–ø–ª—è—Ä—ã
2. ‚úÖ **Best practices —Å–æ–±–ª—é–¥–µ–Ω—ã:** httpx.AsyncClient —Å connection pooling, Semaphore –¥–ª—è rate limiting
3. ‚ö†Ô∏è **–¢—Ä–µ–±—É—é—Ç—Å—è –∏–∑–º–µ–Ω–µ–Ω–∏—è:**
   - CLI: –Ω–æ–≤—ã–π –ø–∞—Ä–∞–º–µ—Ç—Ä `--parsers`
   - `main.py`: —Ñ—É–Ω–∫—Ü–∏—è `_process_products_parallel_async()`
   - `ExcelWriter`: –ø–æ–¥–¥–µ—Ä–∂–∫–∞ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã—Ö –∫–æ–ª–æ–Ω–æ–∫
   - Checkpoint: –Ω–æ–≤–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### 6.2. –†–∏—Å–∫–∏ –∏ –º–∏—Ç–∏–≥–∞—Ü–∏—è

| –†–∏—Å–∫ | –í–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å | –í–ª–∏—è–Ω–∏–µ | –ú–∏—Ç–∏–≥–∞—Ü–∏—è |
|------|-------------|---------|-----------|
| –ü–µ—Ä–µ–≥—Ä—É–∑–∫–∞ —Å–µ—Ä–≤–µ—Ä–æ–≤ | –°—Ä–µ–¥–Ω—è—è | –í—ã—Å–æ–∫–æ–µ | –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–µ rate limits (Semaphore, request_delay) |
| –û—à–∏–±–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | `return_exceptions=True` –≤ `asyncio.gather()` |
| –ü—Ä–æ–±–ª–µ–º—ã —Å –ø–∞–º—è—Ç—å—é (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–ª–∏–µ–Ω—Ç—ã) | –ù–∏–∑–∫–∞—è | –°—Ä–µ–¥–Ω–µ–µ | Connection pooling –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è |
| –°–ª–æ–∂–Ω–æ—Å—Ç—å –æ—Ç–ª–∞–¥–∫–∏ | –°—Ä–µ–¥–Ω—è—è | –ù–∏–∑–∫–æ–µ | –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ |

### 6.3. –ü–ª–∞–Ω —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç)

**–§–∞–∑–∞ 1: –ë–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å (2-3 —á–∞—Å–∞)**
1. ‚úÖ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è CLI (`--parsers`)
2. ‚úÖ –§—É–Ω–∫—Ü–∏—è `_process_products_parallel_async()`
3. ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞–º–∏ (`AsyncExitStack`)
4. ‚úÖ –ë–∞–∑–æ–≤–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 10 —Ç–æ–≤–∞—Ä–∞—Ö

**–§–∞–∑–∞ 2: Excel –∏ Checkpoint (1-2 —á–∞—Å–∞)**
5. ‚úÖ –ú–æ–¥–∏—Ñ–∏–∫–∞—Ü–∏—è `ExcelWriter.write_results()`
6. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ checkpoint –º–µ—Ö–∞–Ω–∏–∑–º–∞
7. ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 100 —Ç–æ–≤–∞—Ä–∞—Ö

**–§–∞–∑–∞ 3: –ü–æ–ª–∏—Ä–æ–≤–∫–∞ (1 —á–∞—Å)**
8. ‚úÖ –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
9. ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ edge cases
10. ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

**–ò—Ç–æ–≥–æ: ~4-6 —á–∞—Å–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏**

---

## 7. –ò–¢–û–ì–û–í–´–ï –î–ê–ù–ù–´–ï

### 7.1. –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ

- ‚úÖ 2 async –ø–∞—Ä—Å–µ—Ä–∞ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç
- ‚úÖ Factory pattern –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
- ‚úÖ AsyncBaseParser –≥–æ—Ç–æ–≤ –∫ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–º—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
- ‚ùå CLI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Ç–æ–ª—å–∫–æ –æ–¥–∏–Ω –ø–∞—Ä—Å–µ—Ä
- ‚ùå ExcelWriter –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –∫–æ–ª–æ–Ω–∫–∏
- ‚ùå –ù–µ—Ç —Ñ—É–Ω–∫—Ü–∏–∏ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–π –æ–±—Ä–∞–±–æ—Ç–∫–∏

### 7.2. –û–∂–∏–¥–∞–µ–º–æ–µ —Å–æ—Å—Ç–æ—è–Ω–∏–µ (–ø–æ—Å–ª–µ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏)

- ‚úÖ CLI –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç `--parsers electronpribor,prist`
- ‚úÖ –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —á–µ—Ä–µ–∑ `asyncio.gather()`
- ‚úÖ ExcelWriter —Å–æ–∑–¥–∞–µ—Ç –∫–æ–ª–æ–Ω–∫–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞
- ‚úÖ Checkpoint –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–∞—Ä—Å–µ—Ä—ã
- ‚úÖ –≠–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏: ~36 –º–∏–Ω—É—Ç –Ω–∞ 8000 —Ç–æ–≤–∞—Ä–æ–≤

### 7.3. –ú–µ—Ç—Ä–∏–∫–∏ —É—Å–ø–µ—Ö–∞

- ‚è±Ô∏è **–í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏:** –°–Ω–∏–∂–µ–Ω–∏–µ —Å ~2.3 —á–∞—Å–∞ –¥–æ ~1.7 —á–∞—Å–∞ (26% —ç–∫–æ–Ω–æ–º–∏—è)
- üìä **–§–æ—Ä–º–∞—Ç –¥–∞–Ω–Ω—ã—Ö:** –û–¥–∏–Ω Excel —Ñ–∞–π–ª –≤–º–µ—Å—Ç–æ –¥–≤—É—Ö
- üîÑ **–ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å:** –û—à–∏–±–∫–∞ –æ–¥–Ω–æ–≥–æ –ø–∞—Ä—Å–µ—Ä–∞ –Ω–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥—Ä—É–≥–∏–µ
- üìà **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å:** –õ–µ–≥–∫–æ –¥–æ–±–∞–≤–∏—Ç—å —Ç—Ä–µ—Ç–∏–π, —á–µ—Ç–≤–µ—Ä—Ç—ã–π –ø–∞—Ä—Å–µ—Ä

---

## 8. –°–õ–ï–î–£–Æ–©–ò–ï –®–ê–ì–ò

1. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –§–∞–∑—ã 1** (–±–∞–∑–æ–≤–∞—è —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å)
2. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ –º–∞–ª–æ–º –Ω–∞–±–æ—Ä–µ –¥–∞–Ω–Ω—ã—Ö
3. **–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –§–∞–∑—ã 2** (Excel –∏ Checkpoint)
4. **–ü–æ–ª–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ** –Ω–∞ 8000 —Ç–æ–≤–∞—Ä–æ–≤
5. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

---

**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–æ—Ç–æ–≤–æ –∫ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏
**–ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç:** üî• –í—ã—Å–æ–∫–∏–π (—ç–∫–æ–Ω–æ–º–∏—è –≤—Ä–µ–º–µ–Ω–∏ –∫—Ä–∏—Ç–∏—á–Ω–∞ –¥–ª—è 8000+ —Ç–æ–≤–∞—Ä–æ–≤)

